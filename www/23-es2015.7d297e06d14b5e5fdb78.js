(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{ArDA:function(n,l,e){"use strict";e.r(l);var o=e("8Y7J");class t{}var a=e("pMnS"),i=e("MKJQ"),u=e("sZkV"),s=e("s7LF"),d=e("Xqnl"),r=e("2MiI"),c=e("iInd"),g=e("hnS/"),h=e("2Rin"),p=e("8RPc"),m=e("SVse"),_=e("6jz6"),C=e("LmEr"),f=e("wd/R");class v{constructor(n,l,e,o,t,a){this.api=n,this.router=l,this.util=e,this.navCtrl=o,this.alertCtrl=t,this.route=a,this.reasons=[],this.comment="",this.isEnabled=!1,this.phone="",this.name="",this.email="",this.token="",this.coupon_code="",this.used_coupon=0,this.discount_amount=0,this.wallet_transId="",this.booking_id=localStorage.getItem("bookingid"),console.log(this.booking_id),this.getOrder(this.booking_id)}getOrder(n){console.log(n),this.api.getBookingById(n).then(n=>{console.log(n),this.order_detail=n[0],this.payment_type=this.order_detail.payment_type,console.log(this.payment_type),""!=this.order_detail.coupon_code&&(this.coupon_code=this.order_detail.coupon_code,this.discount_amount=this.order_detail.discount_amount,this.payment_type=this.order_detail.payment_type,console.log("discount_amount",this.discount_amount),this.getUsedCoupon(this.coupon_code),0==this.discount_amount&&this.getWalletTransactions(this.booking_id))}).catch(n=>{console.log(n)})}getUsedCoupon(n){const l=sessionStorage.getItem("uid");this.api.getUsedCouponByCouponCode(l,n).then(n=>{n&&(console.log("coupon_code",n),this.coupon_details=n[0],this.used_couponId=this.coupon_details.id,this.used_coupon=this.coupon_details.used_coupon-1)}).catch(n=>{console.log(n)})}coupon(){const n=new Date,l=f(n).format("YYYY-MM-DD hh:mm:ss A");let e={id:this.used_couponId,used_coupon:this.used_coupon,createdOn:l};this.api.addUsedCoupon(this.used_couponId.toString(),e).then(n=>{console.log(n)}).catch(n=>{n&&(console.log(n),this.util.showToast(`${n}`,"danger","bottom"))})}getWalletTransactions(n){const l=sessionStorage.getItem("uid");this.api.getWalletTransactionsByBooking(l,n).then(n=>{n&&(console.log("booking_id",n),this.wallet_details=n[0],this.wallet_transId=this.wallet_details.id)}).catch(n=>{console.log(n)})}updateWalletTransactions(){const n=new Date,l=f(n).format("YYYY-MM-DD hh:mm:ss A");let e={id:this.wallet_transId,status:"cancel",createdAt:l};this.api.addWalletTransaction(this.wallet_transId.toString(),e).then(n=>{console.log(n)}).catch(n=>{n&&(console.log(n),this.util.showToast(`${n}`,"danger","bottom"))})}ngOnInit(){this.api.remarks().then(n=>{this.reasons=n,console.log(this.reasons)}).catch(n=>{console.log(n)});const n=sessionStorage.getItem("uid");this.api.getMyProfile(n).then(n=>{console.log("my profile",n),n&&(console.log(n),this.phone=n.phone,this.name=n.name,this.email=n.email,this.token=n.fcm_token,null==this.name?this.email="":console.log("trigger else"))},n=>{console.log(n)}).catch(n=>{console.log(n)})}select(n,l){this.reason=n,this.reason_text=l,this.isEnabled=!0}submit(){this.util.show("Please wait....");const n=new Date,l=f(n).format("YYYY-MM-DD hh:mm:ss A");let e={};e="Online"==this.payment_type?{status:4,updatedAt:l,reason:this.reason,remark:this.comment}:{status:7,updatedAt:l,reason:this.reason,remark:this.comment},this.api.updateBooking(this.booking_id,e).then(n=>{this.util.publishOrderStatus("true"),this.util.hide(),this.sendCancelOrderSMS(),""!=this.coupon_code&&this.coupon(),""!=this.wallet_transId&&this.updateWalletTransactions(),this.util.showToast("Your booking cancelled successfully","primary","bottom"),this.router.navigate(["/bookings"])}).catch(n=>{n&&(this.util.hide(),console.log(n),this.util.showToast(`${n}`,"danger","bottom"))})}sendCancelOrderSMS(){let n="https://demo.orgmachine.com/way2lab_sms/cancel_order.php?orderid="+this.booking_id+"&mobile="+this.phone+"&name="+this.name;console.log(n),this.api.sendSms(n).subscribe(n=>{console.log(n)},n=>{console.log("err",n)})}}var b=o["\u0275crt"]({encapsulation:0,styles:[["ion-content[_ngcontent-%COMP%]{--background:#f5f5f5}ion-content[_ngcontent-%COMP%]   .cnt[_ngcontent-%COMP%]{padding:32px 30%}ion-content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{border-radius:0;margin:12px 1px}ion-content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--border-color:transparent}ion-content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .sc-ion-label-md-h[_ngcontent-%COMP%]{text-overflow:unset;font-size:14px}ion-content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-radio[_ngcontent-%COMP%]{margin:10px 10px 10px 0}ion-content[_ngcontent-%COMP%]   .textarea[_ngcontent-%COMP%]{border:1px solid #e6e6e6;border-radius:5px!important;font-size:14px;margin-top:0;color:#000;background:#fff;margin-bottom:20px}"]],data:{}});function M(n){return o["\u0275vid"](0,[(n()(),o["\u0275eld"](0,0,null,null,19,"div",[],null,null,null,null,null)),(n()(),o["\u0275eld"](1,0,null,null,18,"ion-card-content",[["style","padding: 0px;"]],null,null,null,i.R,i.g)),o["\u0275did"](2,49152,null,0,u.IonCardContent,[o.ChangeDetectorRef,o.ElementRef,o.NgZone],null,null),(n()(),o["\u0275eld"](3,0,null,0,16,"ion-radio-group",[],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"ionChange"],[null,"ionBlur"]],(function(n,l,e){var t=!0,a=n.component;return"ionBlur"===l&&(t=!1!==o["\u0275nov"](n,4)._handleBlurEvent(e.target)&&t),"ionChange"===l&&(t=!1!==o["\u0275nov"](n,4)._handleChangeEvent(e.target)&&t),"ngModelChange"===l&&(t=!1!==(a.reason=e)&&t),"ionChange"===l&&(t=!1!==a.select(a.reason,n.context.$implicit.reason)&&t),t}),i.kb,i.z)),o["\u0275did"](4,16384,null,0,u.SelectValueAccessor,[o.ElementRef],null,null),o["\u0275prd"](1024,null,s.NG_VALUE_ACCESSOR,(function(n){return[n]}),[u.SelectValueAccessor]),o["\u0275did"](6,671744,null,0,s.NgModel,[[8,null],[8,null],[8,null],[6,s.NG_VALUE_ACCESSOR]],{model:[0,"model"],options:[1,"options"]},{update:"ngModelChange"}),o["\u0275pod"](7,{standalone:0}),o["\u0275prd"](2048,null,s.NgControl,null,[s.NgModel]),o["\u0275did"](9,16384,null,0,s.NgControlStatus,[[4,s.NgControl]],null,null),o["\u0275did"](10,49152,null,0,u.IonRadioGroup,[o.ChangeDetectorRef,o.ElementRef,o.NgZone],null,null),(n()(),o["\u0275eld"](11,0,null,0,8,"ion-item",[],null,null,null,i.db,i.r)),o["\u0275did"](12,49152,null,0,u.IonItem,[o.ChangeDetectorRef,o.ElementRef,o.NgZone],null,null),(n()(),o["\u0275eld"](13,0,null,0,2,"ion-label",[],null,null,null,i.eb,i.s)),o["\u0275did"](14,49152,null,0,u.IonLabel,[o.ChangeDetectorRef,o.ElementRef,o.NgZone],null,null),(n()(),o["\u0275ted"](15,0,["",""])),(n()(),o["\u0275eld"](16,0,null,0,3,"ion-radio",[["slot","start"]],null,[[null,"ionBlur"],[null,"ionSelect"]],(function(n,l,e){var t=!0;return"ionBlur"===l&&(t=!1!==o["\u0275nov"](n,19)._handleBlurEvent(e.target)&&t),"ionSelect"===l&&(t=!1!==o["\u0275nov"](n,19)._handleIonSelect(e.target)&&t),t}),i.lb,i.y)),o["\u0275prd"](5120,null,s.NG_VALUE_ACCESSOR,(function(n){return[n]}),[u.RadioValueAccessor]),o["\u0275did"](18,49152,null,0,u.IonRadio,[o.ChangeDetectorRef,o.ElementRef,o.NgZone],{value:[0,"value"]},null),o["\u0275did"](19,16384,null,0,u.RadioValueAccessor,[o.ElementRef],null,null)],(function(n,l){var e=l.component.reason,t=n(l,7,0,!0);n(l,6,0,e,t),n(l,18,0,o["\u0275inlineInterpolate"](1,"",l.context.$implicit.id,""))}),(function(n,l){n(l,3,0,o["\u0275nov"](l,9).ngClassUntouched,o["\u0275nov"](l,9).ngClassTouched,o["\u0275nov"](l,9).ngClassPristine,o["\u0275nov"](l,9).ngClassDirty,o["\u0275nov"](l,9).ngClassValid,o["\u0275nov"](l,9).ngClassInvalid,o["\u0275nov"](l,9).ngClassPending),n(l,15,0,l.context.$implicit.reason)}))}function R(n){return o["\u0275vid"](0,[(n()(),o["\u0275eld"](0,0,null,null,1,"app-header",[],null,null,null,d.b,d.a)),o["\u0275did"](1,114688,null,0,r.a,[c.m,u.NavController,g.a,h.a,p.a],null,null),(n()(),o["\u0275eld"](2,0,null,null,24,"ion-content",[],null,null,null,i.W,i.k)),o["\u0275did"](3,49152,null,0,u.IonContent,[o.ChangeDetectorRef,o.ElementRef,o.NgZone],null,null),(n()(),o["\u0275eld"](4,0,null,0,20,"div",[["class","cnt"]],null,null,null,null,null)),(n()(),o["\u0275eld"](5,0,null,null,2,"p",[],null,null,null,null,null)),(n()(),o["\u0275eld"](6,0,null,null,1,"b",[],null,null,null,null,null)),(n()(),o["\u0275ted"](-1,null,["Why are you cancelling this?"])),(n()(),o["\u0275eld"](8,0,null,null,3,"ion-card",[],null,null,null,i.U,i.f)),o["\u0275did"](9,49152,null,0,u.IonCard,[o.ChangeDetectorRef,o.ElementRef,o.NgZone],null,null),(n()(),o["\u0275and"](16777216,null,0,1,null,M)),o["\u0275did"](11,278528,null,0,m.NgForOf,[o.ViewContainerRef,o.TemplateRef,o.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(n()(),o["\u0275eld"](12,0,null,null,2,"p",[],null,null,null,null,null)),(n()(),o["\u0275eld"](13,0,null,null,1,"b",[],null,null,null,null,null)),(n()(),o["\u0275ted"](-1,null,["Comments (optional)"])),(n()(),o["\u0275eld"](15,0,null,null,6,"ion-textarea",[["auto-grow","true"],["class","textarea"],["cols","20"],["placeholder","Describe what's wrong with the order"],["rows","6"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"ionBlur"],[null,"ionChange"]],(function(n,l,e){var t=!0,a=n.component;return"ionBlur"===l&&(t=!1!==o["\u0275nov"](n,16)._handleBlurEvent(e.target)&&t),"ionChange"===l&&(t=!1!==o["\u0275nov"](n,16)._handleInputEvent(e.target)&&t),"ngModelChange"===l&&(t=!1!==(a.comment=e)&&t),t}),i.ub,i.I)),o["\u0275did"](16,16384,null,0,u.TextValueAccessor,[o.ElementRef],null,null),o["\u0275prd"](1024,null,s.NG_VALUE_ACCESSOR,(function(n){return[n]}),[u.TextValueAccessor]),o["\u0275did"](18,671744,null,0,s.NgModel,[[8,null],[8,null],[8,null],[6,s.NG_VALUE_ACCESSOR]],{model:[0,"model"]},{update:"ngModelChange"}),o["\u0275prd"](2048,null,s.NgControl,null,[s.NgModel]),o["\u0275did"](20,16384,null,0,s.NgControlStatus,[[4,s.NgControl]],null,null),o["\u0275did"](21,49152,null,0,u.IonTextarea,[o.ChangeDetectorRef,o.ElementRef,o.NgZone],{cols:[0,"cols"],placeholder:[1,"placeholder"],rows:[2,"rows"]},null),(n()(),o["\u0275eld"](22,0,null,null,2,"ion-button",[["expand","block"]],null,[[null,"click"]],(function(n,l,e){var o=!0;return"click"===l&&(o=!1!==n.component.submit()&&o),o}),i.P,i.d)),o["\u0275did"](23,49152,null,0,u.IonButton,[o.ChangeDetectorRef,o.ElementRef,o.NgZone],{disabled:[0,"disabled"],expand:[1,"expand"]},null),(n()(),o["\u0275ted"](-1,0,[" Submit "])),(n()(),o["\u0275eld"](25,0,null,0,1,"app-footer",[],null,null,null,_.b,_.a)),o["\u0275did"](26,114688,null,0,C.a,[c.m,u.NavController,g.a,h.a,p.a,u.ModalController],null,null)],(function(n,l){var e=l.component;n(l,1,0),n(l,11,0,e.reasons),n(l,18,0,e.comment),n(l,21,0,"20","Describe what's wrong with the order","6"),n(l,23,0,!e.isEnabled,"block"),n(l,26,0)}),(function(n,l){n(l,15,0,o["\u0275nov"](l,20).ngClassUntouched,o["\u0275nov"](l,20).ngClassTouched,o["\u0275nov"](l,20).ngClassPristine,o["\u0275nov"](l,20).ngClassDirty,o["\u0275nov"](l,20).ngClassValid,o["\u0275nov"](l,20).ngClassInvalid,o["\u0275nov"](l,20).ngClassPending)}))}function I(n){return o["\u0275vid"](0,[(n()(),o["\u0275eld"](0,0,null,null,1,"app-cancel",[],null,null,null,R,b)),o["\u0275did"](1,114688,null,0,v,[p.a,c.m,h.a,u.NavController,u.AlertController,c.a],null,null)],(function(n,l){n(l,1,0)}),null)}var S=o["\u0275ccf"]("app-cancel",v,I,{},{},[]),k=e("STSa"),w=e("xnLu"),y=e("TSSN"),N=e("dVnR"),O=e("j1ZV");class E{}e.d(l,"CancelPageModuleNgFactory",(function(){return A}));var A=o["\u0275cmf"](t,[],(function(n){return o["\u0275mod"]([o["\u0275mpd"](512,o.ComponentFactoryResolver,o["\u0275CodegenComponentFactoryResolver"],[[8,[a.a,S]],[3,o.ComponentFactoryResolver],o.NgModuleRef]),o["\u0275mpd"](4608,m.NgLocalization,m.NgLocaleLocalization,[o.LOCALE_ID,[2,m["\u0275angular_packages_common_common_a"]]]),o["\u0275mpd"](4608,s["\u0275angular_packages_forms_forms_o"],s["\u0275angular_packages_forms_forms_o"],[]),o["\u0275mpd"](4608,u.AngularDelegate,u.AngularDelegate,[o.NgZone,o.ApplicationRef]),o["\u0275mpd"](4608,u.ModalController,u.ModalController,[u.AngularDelegate,o.ComponentFactoryResolver,o.Injector]),o["\u0275mpd"](4608,u.PopoverController,u.PopoverController,[u.AngularDelegate,o.ComponentFactoryResolver,o.Injector]),o["\u0275mpd"](4608,s.FormBuilder,s.FormBuilder,[]),o["\u0275mpd"](1073742336,m.CommonModule,m.CommonModule,[]),o["\u0275mpd"](1073742336,s["\u0275angular_packages_forms_forms_d"],s["\u0275angular_packages_forms_forms_d"],[]),o["\u0275mpd"](1073742336,s.FormsModule,s.FormsModule,[]),o["\u0275mpd"](1073742336,u.IonicModule,u.IonicModule,[]),o["\u0275mpd"](1073742336,k.b,k.b,[]),o["\u0275mpd"](1073742336,w.a,w.a,[]),o["\u0275mpd"](1073742336,y.g,y.g,[]),o["\u0275mpd"](1073742336,N.a,N.a,[]),o["\u0275mpd"](1073742336,s.ReactiveFormsModule,s.ReactiveFormsModule,[]),o["\u0275mpd"](1073742336,O.a,O.a,[]),o["\u0275mpd"](1073742336,c.o,c.o,[[2,c.t],[2,c.m]]),o["\u0275mpd"](1073742336,E,E,[]),o["\u0275mpd"](1073742336,t,t,[]),o["\u0275mpd"](1024,c.k,(function(){return[[{path:"",component:v}]]}),[])])}))}}]);